resource "google_compute_instance_from_template" "template-private-1" {
  name    = "${var.instance_name}-1"
  zone    = "us-central1-a"
  project = var.project

  source_instance_template = google_compute_instance_template.template-private.id
}

resource "google_compute_instance_from_template" "template-private-2" {
  name    = "${var.instance_name}-2"
  zone    = "us-central1-b"
  project = var.project

  source_instance_template = google_compute_instance_template.template-private.id
}

resource "google_compute_instance_from_template" "template-private-3" {
  name    = "${var.instance_name}-3"
  zone    = "us-central1-c"
  project = var.project

  source_instance_template = google_compute_instance_template.template-private.id
}

resource "google_compute_instance_group" "tomcat-group" {
  name        = "nginx-group"
  project     = var.project
  description = "Terraform tpmcat instance group"

  instances = [
    google_compute_instance_from_template.template-private-1.id,
    google_compute_instance_from_template.template-private-2.id,
    google_compute_instance_from_template.template-private-3.id,
  ]

  named_port {
    name = "http"
    port = "8080"
  }
}